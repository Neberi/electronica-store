{% extends 'admin_panel/base.html' %}

{% block title %}–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –ì–ª–∞–≤–Ω–∞—è{% endblock %}

{% block page_title %}üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞{% endblock %}

{% block content %}
<div class="admin-stats">
    <div class="stat-card">
        <h3>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
        <div class="stat-value">{{ total_users }}</div>
        <p>–í—Å–µ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö</p>
        <div class="stat-change">‚ÜóÔ∏è +12 –∑–∞ –º–µ—Å—è—Ü</div>
    </div>

    <div class="stat-card">
        <h3>üì¶ –ó–∞–∫–∞–∑—ã</h3>
        <div class="stat-value">{{ total_orders }}</div>
        <p>–í—Å–µ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–æ</p>
        <div class="stat-change">üîÑ {{ conversion_rate }}% –∫–æ–Ω–≤–µ—Ä—Å–∏—è</div>
    </div>

    <div class="stat-card">
        <h3>üíµ –î–æ—Ö–æ–¥</h3>
        <div class="stat-value">{{ recent_revenue|floatformat:0 }} ‚ÇΩ</div>
        <p>–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</p>
        <div class="stat-change">üìà +15% –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É</div>
    </div>

    <div class="stat-card">
        <h3>‚≠ê –û—Ç–∑—ã–≤—ã</h3>
        <div class="stat-value">{{ total_reviews }}</div>
        <p>–í—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤</p>
        <div class="stat-change">üëç 95% –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö</div>
    </div>
</div>

<h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –∑–∞–∫–∞–∑–æ–≤</h2>
<div class="stats-chart">
    <table class="admin-table">
        <thead>
            <tr>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
            </tr>
        </thead>
        <tbody>
            {% for stat in order_stats %}
            <tr>
                <td>
                    <span class="status-badge status-{{ stat.status }}">
                        {{ stat.status }}
                    </span>
                </td>
                <td>{{ stat.count }}</td>
                <td>{{ stat.percentage|default:"0" }}%</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h2>
{% if recent_orders %}
<table class="admin-table">
    <thead>
        <tr>
            <th>‚Ññ –∑–∞–∫–∞–∑–∞</th>
            <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
            <th>–î–∞—Ç–∞</th>
            <th>–°—É–º–º–∞</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
    </thead>
    <tbody>
        {% for order in recent_orders %}
        <tr>
            <td><strong>#{{ order.order_number }}</strong></td>
            <td>{{ order.user.username }}</td>
            <td>{{ order.created_at|date:"d.m.Y H:i" }}</td>
            <td>{{ order.final_amount }} ‚ÇΩ</td>
            <td>
                <span class="status-badge status-{{ order.status }}">
                    {{ order.get_status_display }}
                </span>
            </td>
            <td>
                <a href="{% url 'main:admin_order_detail' order.id %}" class="btn btn-primary btn-sm">
                    üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<a href="{% url 'main:admin_orders' %}" class="btn btn-primary">
    –í—Å–µ –∑–∞–∫–∞–∑—ã ‚Üí
</a>
{% else %}
<p>–ù–µ—Ç –Ω–µ–¥–∞–≤–Ω–∏—Ö –∑–∞–∫–∞–∑–æ–≤</p>
{% endif %}
{% endblock %}