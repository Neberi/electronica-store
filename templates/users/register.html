{% extends 'base.html' %}

{% block title %}–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - Electronica Store{% endblock %}

{% block content %}
<div class="header-nav">
    <a href="{% url 'main:index' %}" class="nav-link">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
</div>

<div class="auth-container">
    <div class="auth-card">
        <div class="auth-decoration">
            <div class="auth-icon">‚ú®</div>
        </div>

        <h1 class="auth-title">–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞</h1>
        <p class="auth-subtitle">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞—à–µ–º—É —Å–æ–æ–±—â–µ—Å—Ç–≤—É —ç–ª–µ–∫—Ç—Ä–æ–Ω—â–∏–∫–æ–≤</p>

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <form method="post" class="auth-form">
            {% csrf_token %}

            {% if form.errors %}
            <div class="alert alert-error">
                ‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ —Ñ–æ—Ä–º–µ –Ω–∏–∂–µ.
            </div>
            {% endif %}

            <div class="form-group">
                <label for="id_username" class="form-label">
                    üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                </label>
                {{ form.username }}
                {% if form.username.errors %}
                <div class="error-text">
                    {{ form.username.errors }}
                </div>
                {% endif %}
                <small class="form-help">‚Ä¢ –ù–µ –±–æ–ª–µ–µ 150 —Å–∏–º–≤–æ–ª–æ–≤<br>‚Ä¢ –¢–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ @/./+/-/_</small>
            </div>

            <div class="form-group">
                <label for="id_email" class="form-label">
                    üìß Email –∞–¥—Ä–µ—Å
                </label>
                {{ form.email }}
                {% if form.email.errors %}
                <div class="error-text">
                    {{ form.email.errors }}
                </div>
                {% endif %}
                <small class="form-help">‚Ä¢ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ<br>‚Ä¢ –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º</small>
            </div>

            <div class="form-group">
                <label for="id_secret_question" class="form-label">
                    ‚ùì –°–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
                </label>
                {{ form.secret_question }}
                {% if form.secret_question.errors %}
                <div class="error-text">
                    {{ form.secret_question.errors }}
                </div>
                {% endif %}
                <small class="form-help">‚Ä¢ –ù–∞–ø—Ä–∏–º–µ—Ä: "–î–µ–≤–∏—á—å—è —Ñ–∞–º–∏–ª–∏—è –º–∞—Ç–µ—Ä–∏?"</small>
            </div>

            <div class="form-group">
                <label for="id_secret_answer" class="form-label">
                    üîê –û—Ç–≤–µ—Ç –Ω–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å
                </label>
                {{ form.secret_answer }}
                {% if form.secret_answer.errors %}
                <div class="error-text">
                    {{ form.secret_answer.errors }}
                </div>
                {% endif %}
                <small class="form-help">‚Ä¢ –ó–∞–ø–æ–º–Ω–∏—Ç–µ —ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç<br>‚Ä¢ –û–Ω –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è</small>
            </div>

            <div class="form-group">
                <label for="id_password1" class="form-label">
                    üîí –ü–∞—Ä–æ–ª—å
                </label>
                {{ form.password1 }}
                {% if form.password1.errors %}
                <div class="error-text">
                    {{ form.password1.errors }}
                </div>
                {% endif %}
                <small class="form-help">
                    ‚Ä¢ –ù–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤<br>
                    ‚Ä¢ –ù–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç—ã–º<br>
                    ‚Ä¢ –ù–µ –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑ —Ü–∏—Ñ—Ä
                </small>
                <div class="password-strength">
                    <div class="strength-bar strength-weak"></div>
                </div>
            </div>

            <div class="form-group">
                <label for="id_password2" class="form-label">
                    üîí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
                </label>
                {{ form.password2 }}
                {% if form.password2.errors %}
                <div class="error-text">
                    {{ form.password2.errors }}
                </div>
                {% endif %}
                <small class="form-help">‚Ä¢ –í–≤–µ–¥–∏—Ç–µ —Ç–æ—Ç –∂–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</small>
            </div>

            <button type="submit" class="auth-button register">
                üéâ –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
            </button>
        </form>

        <div class="auth-links">
            <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="{% url 'users:login' %}" class="auth-link">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</a></p>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const password1 = document.getElementById('id_password1');
    const password2 = document.getElementById('id_password2');
    const strengthBar = document.querySelector('.strength-bar');

    function checkPasswordStrength(password) {
        let strength = 0;

        if (password.length >= 8) strength += 1;
        if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength += 1;
        if (password.match(/\d/)) strength += 1;
        if (password.match(/[^a-zA-Z\d]/)) strength += 1;

        return strength;
    }

    function updateStrengthBar(strength) {
        strengthBar.className = 'strength-bar';

        if (strength === 0) {
            strengthBar.classList.add('strength-weak');
        } else if (strength <= 2) {
            strengthBar.classList.add('strength-medium');
        } else {
            strengthBar.classList.add('strength-strong');
        }
    }

    if (password1) {
        password1.addEventListener('input', function() {
            const strength = checkPasswordStrength(this.value);
            updateStrengthBar(strength);
        });
    }

    if (password2 && password1) {
        password2.addEventListener('input', function() {
            if (this.value !== password1.value) {
                this.classList.add('error');
            } else {
                this.classList.remove('error');
                this.classList.add('success');
            }
        });
    }
});
</script>
{% endblock %}